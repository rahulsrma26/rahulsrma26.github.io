{"componentChunkName":"component---src-templates-articles-index-js","path":"/articles/falling-matrix","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Animation using HTML5 and javascript","description":"The HTML5 canvas element is very helpful in drawing graphics on the fly. Using javascript we can create various animations without relying on the flash or heavy GIF files. Due to security reasons Flash support is decreasing and canvas support is increasing. This article shows how to create falling text (matrix style) animation using HTML5 canvas and javascript.","tags":["javascript","animation","graphics"],"date":"2014-03-24T00:00:00.000Z"},"fields":{"slug":"falling-matrix","postType":"articles"},"html":"<p>This is how the end result will looks like:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.703125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACMElEQVQozzVSXW/aQBC82zt/YHI2tjHF0IABE75JA4hAMSJVH/pQqWqR2qjtH6jU///eWZtalrXem92Z2T0xuoyO34+L80IIIUniJUWIk36Sb3IEVmxJT+IJ+6GQwk/8+WmOPMPyXX75ebmf37dHbbfu3rJCBEkQd2OgvYUXpIHne9PjlDQ1ksbjl0fkiUj0F/3leQn05fUStkPmx2NJaaQUUllKRjLf5vF9XB2xMldJh08FCLNVhoPdp53f9CtmnFGDcCyVRGa8HwM2eBp0Z10RlN2VJJ8E9JjYADE9TxFzcUBgRqA8FS0iEMTjuNFsFNcif86FV3ZHsQd36G+zTjdyOQs5WiSDBBZszy5eC/gUSliOlT1l2tY38Yakhu+EqEmU8pDojsjhoLfopcPUuXOGz0POS6IaqTeKKzX7xpebQiRFxOTgtMttQYdtwXP6Lp29zLhASQBgkqySEOIs/bB/KNEwQEzYGrbCLKyohCU6q87179WsDRTx8PBGsuKHo8PXw/+LgWISp9+n7MCTBwO+JjKTzcTf+Dpgq0CMf41r32p8c1xr+3l708lOjCx+FFEvYhxR1bTSDJ1cKmj9Z137yMVIZR+yshhXwuEBTrYTp+5wcY9ue8ZStML+Oa5Jd+NiTgCz8o5dzr3O/xiJ1ho9TWhaqxY865bG16k5q5cVbxFYX1Z3y57a+q2+DQz/FBMmj5advDM7zLBbFSmIQhnuOZqGy3D0flRpds+u2Zt/I/0qdV4CJ5cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"matrix\"\n        title=\"matrix\"\n        src=\"/static/5ab79434421cc12d9046a4f45911be9f/c5bb3/matrix.png\"\n        srcset=\"/static/5ab79434421cc12d9046a4f45911be9f/6f3f2/matrix.png 256w,\n/static/5ab79434421cc12d9046a4f45911be9f/01e7c/matrix.png 512w,\n/static/5ab79434421cc12d9046a4f45911be9f/c5bb3/matrix.png 680w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><a href=\"https://jsfiddle.net/welcometors/tz38d5vg/1/\" target=\"_blank\">Click here to see live demo with code</a></p>\n<p>First we need to create an HTML5 canvas. A HTML5 canvas is used to draw graphics. Almost all of the flash graphics are pretty much replaced by canvas today.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>canvas</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>background<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>512<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>360<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>canvas</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This will be served as an output screen for our animation.</p>\n<p>Now, we can access the canvas in javascript:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> canvas <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'background'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> context <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Canvas</strong> object contains the properties related to output window like width, height etc.\n<strong>Context</strong> object will be used to call in-built functions for drawing, writing etc.</p>\n<p>Let us assume that our text string is \"test\", which is falling vertically in our output screen.\nAlso, we need multiple instances of it.<br>\nLet us assume that the coordinates of the top left corner of a text instance is <em>x</em> and <em>y</em>.\nSee below:</p>\n<img alt=\"screen\" src=\"/downloads/0e4c4e44116712630bf2c0a0dec7c574/screen.svg\" style=\"width:50%\" class=\"invertable\">\n<p>I encapsulated one of them in a dotted box to showcase the top right coner of a single instance.\nSince, we don't have infinite memory for our infinitely falling matrix text instances. So we need to reuse them.\nA clever trick is to change the coordinate back to the top when they cross the bottom of the screen.</p>\n<img alt=\"screenTransition\" src=\"/downloads/b2afb81ec50dcc780d784a2cc781b7bd/screenTransition.svg\" class=\"invertable\">\n<p>This way, we only need few instances to make our screen look full.\nTo avoid them form keep falling in the same column we can re-randomize <em>x</em> while changing <em>y</em> to top.  </p>\n<p>If you have worked with any graphics library in the past then you will be familiar with the coordinate system of canvas.\nTop left corner will be <em>(0,0)</em> and <em>x</em> will increase as you go right and <em>y</em> will increase as you go down.\nWe'll be moving our text in range <em>(x,-screenHeight)</em> to <em>(x,+screenHeight)</em> for some randomized <em>x</em>.</p>\n<p>For moving text we are creating a class (called Bit) to manage them as an individual objects.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Bit</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// x and y positions are initialized randomly</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>xpos <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">-</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// this draw the text for current frame</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">draw</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Formatting the text to display</span>\n        context<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'green'</span><span class=\"token punctuation\">;</span>\n        context<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token string\">'14pt Calibri'</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">var</span> text <span class=\"token operator\">=</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> textWidth <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"W.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// we need to draw the characters of the text</span>\n        <span class=\"token comment\">// one by one from top to bottom</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>text<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> charaterWidth <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n            context<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span> text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> \n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>xpos <span class=\"token operator\">-</span> charaterWidth<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> \n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">+</span> i<span class=\"token operator\">*</span>textWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token comment\">// this will update the text for next frame</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">tick</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">></span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// if text crosses the bottom of the screen then reset </span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">=</span> <span class=\"token operator\">-</span>canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>xpos <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// drop text by 2 pixels down</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For testing, we'll create some of the <strong>Bit</strong> objects:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> bits <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span>\n    bits<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Bit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now, we need a function to redraw at every frame.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">reDraw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// before drawing clear entire screen</span>\n    context<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'black'</span><span class=\"token punctuation\">;</span>\n    context<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// draw every text elements</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> bit <span class=\"token keyword\">in</span> bits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        bits<span class=\"token punctuation\">[</span>bit<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        bits<span class=\"token punctuation\">[</span>bit<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">tick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// This will call 'reDraw' at every 33 milliseconds. </span>\n<span class=\"token comment\">// So, our animation will run at 30fps (1000/33 ≈ 30).</span>\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span>reDraw<span class=\"token punctuation\">,</span> <span class=\"token number\">33</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now, our code will run like this:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.3125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAAAx0lEQVQoz3WTCxLDIAhEUTS0SXr/61bXrPGbcSaCPFkRRaLkz3F8OUnfIeKbper/0J+jBYbCviRvFwnrBKdhFT4Rp3Al+wcm7jM7rD4qLvyUkxNaas7QY4OQHB2JFUlGIeV4rq9CaGqUyZLngO3h8YSNcQfMiMgX9tjMekmegpWmrarw6LFNbVwjR5tLemG3uZKBTwlu6fpiEbSEL9yCLWGFN1DeDN88cJjhckNh01W1JQelL1wyhx4uzacTNsr2m2cQZXw8HH856wLc9ZD6LQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"matrix_test\"\n        title=\"matrix_test\"\n        src=\"/static/ea0377e097cc1ef2bfa9b0b89412df74/01e7c/matrix_test.png\"\n        srcset=\"/static/ea0377e097cc1ef2bfa9b0b89412df74/6f3f2/matrix_test.png 256w,\n/static/ea0377e097cc1ef2bfa9b0b89412df74/01e7c/matrix_test.png 512w\"\n        sizes=\"(max-width: 512px) 100vw, 512px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><a href=\"https://jsfiddle.net/welcometors/tz38d5vg/0/\" target=\"_blank\">Click here to see live demo with code</a></p>\n<p>Make sure you understood above code completely before moving ahead.</p>\n<hr>\n<p>Now, we need to add depth (i.e. some text are near and some are far) in our falling matrix.\nThis can be achieved by changing the text size, falling speed and brightness according to the depth.</p>\n<p>We need different colors and bunch of randomized symbols:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'#008800'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#00FF00'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#55FF55'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'#BBFFBB'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> words <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"昨天\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"小时\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"钟表\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"漂亮\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"常见\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"說這\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"안녕하\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"그래서\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"안녕하\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"십니까\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"洗手在\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"笑好玩儿\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"么希奇的\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"환영합니다\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"好吃的食物\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We need to change our <strong>Bit</strong> class for depth (distance).</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">Bit</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">distance</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// size and speed are inversely proportional to distance</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>speed <span class=\"token operator\">=</span> <span class=\"token number\">160</span> <span class=\"token operator\">/</span> distance<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fontSize <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">*</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>speed<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token comment\">// font and color will be decided accordingly</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fontSize<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span><span class=\"token string\">'pt Calibri'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> colors<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fontSize<span class=\"token operator\">-</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>xpos <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">-</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">draw</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        context<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">;</span>\n        context<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">var</span> text <span class=\"token operator\">=</span> words<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> textWidth <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"W.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>text<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">var</span> charaterWidth <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n            context<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span> text<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> \n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>xpos <span class=\"token operator\">-</span> charaterWidth<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> \n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">+</span> i<span class=\"token operator\">*</span>textWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">tick</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">></span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">=</span> <span class=\"token operator\">-</span> canvas<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>xpos <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> canvas<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ypos <span class=\"token operator\">+=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>speed<span class=\"token punctuation\">;</span>\n        \n        <span class=\"token comment\">// we will give 2% change to change the text</span>\n        <span class=\"token keyword\">var</span> chance <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> chance <span class=\"token operator\">&lt;</span> <span class=\"token number\">.01</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// change to next word</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> chance <span class=\"token operator\">&lt;</span> <span class=\"token number\">.02</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// change to previous word</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>text <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">+</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For the motion blur effect we just need to change one line in the <em>redraw()</em></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">context<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'rgba(0,0,0,0.4)'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Instead of putting an opaque black rectangle, we can put a transparent one.\nAs a result, previous frame will slowly fade away, frame by frame, instead of disappearing at once.\nAnd on screen, it’ll look like text is leaving a trail behind. Which will serve as our fake motion blur.</p>\n<p>We can also change the canvas size programmatically to adapt to the window size.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">context<span class=\"token punctuation\">.</span>canvas<span class=\"token punctuation\">.</span>width  <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerWidth<span class=\"token punctuation\">;</span>\ncontext<span class=\"token punctuation\">.</span>canvas<span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Final results:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.703125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACMElEQVQozzVSXW/aQBC82zt/YHI2tjHF0IABE75JA4hAMSJVH/pQqWqR2qjtH6jU///eWZtalrXem92Z2T0xuoyO34+L80IIIUniJUWIk36Sb3IEVmxJT+IJ+6GQwk/8+WmOPMPyXX75ebmf37dHbbfu3rJCBEkQd2OgvYUXpIHne9PjlDQ1ksbjl0fkiUj0F/3leQn05fUStkPmx2NJaaQUUllKRjLf5vF9XB2xMldJh08FCLNVhoPdp53f9CtmnFGDcCyVRGa8HwM2eBp0Z10RlN2VJJ8E9JjYADE9TxFzcUBgRqA8FS0iEMTjuNFsFNcif86FV3ZHsQd36G+zTjdyOQs5WiSDBBZszy5eC/gUSliOlT1l2tY38Yakhu+EqEmU8pDojsjhoLfopcPUuXOGz0POS6IaqTeKKzX7xpebQiRFxOTgtMttQYdtwXP6Lp29zLhASQBgkqySEOIs/bB/KNEwQEzYGrbCLKyohCU6q87179WsDRTx8PBGsuKHo8PXw/+LgWISp9+n7MCTBwO+JjKTzcTf+Dpgq0CMf41r32p8c1xr+3l708lOjCx+FFEvYhxR1bTSDJ1cKmj9Z137yMVIZR+yshhXwuEBTrYTp+5wcY9ue8ZStML+Oa5Jd+NiTgCz8o5dzr3O/xiJ1ho9TWhaqxY865bG16k5q5cVbxFYX1Z3y57a+q2+DQz/FBMmj5advDM7zLBbFSmIQhnuOZqGy3D0flRpds+u2Zt/I/0qdV4CJ5cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"matrix\"\n        title=\"matrix\"\n        src=\"/static/5ab79434421cc12d9046a4f45911be9f/c5bb3/matrix.png\"\n        srcset=\"/static/5ab79434421cc12d9046a4f45911be9f/6f3f2/matrix.png 256w,\n/static/5ab79434421cc12d9046a4f45911be9f/01e7c/matrix.png 512w,\n/static/5ab79434421cc12d9046a4f45911be9f/c5bb3/matrix.png 680w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><a href=\"https://jsfiddle.net/welcometors/tz38d5vg/1/\" target=\"_blank\">Click here to see live demo with code</a></p>"}},"pageContext":{"id":"3748b67a-883b-52f0-a9a3-31b850d816da"}},"staticQueryHashes":["1271460761","3159585216","805030655"]}