{"componentChunkName":"component---src-templates-articles-index-js","path":"/articles/smb-mount","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Mounting SMB share on Ubuntu/Mint","description":"You might be running a NAS sever on your local network or sharing some drive on different windows PC that you want to access on your linux server/desktop.  In this post, we will learn how to auto mount on your machine with different access level.","tags":["linux","shell","network","smb"],"date":"2023-05-16T00:00:00.000Z","image":{"id":"7db695df-cbae-5d25-b01f-fb627ea0078a","publicURL":"/static/2c4517c0eea9b3ceedb9a70173ab6db1/preview.jpg"}},"fields":{"slug":"smb-mount","postType":"articles"},"html":"<p>Server Message Block (SMB) is a communication protocol[1] originally developed in 1983 by Barry A. Feigenbaum at IBM. SMB enables file sharing, printer sharing, network browsing, and inter-process communication (through named pipes) over a computer network. SMB serves as the basis for Microsoft's Distributed File System implementation. SMB relies on the TCP and IP protocols for transport. This combination allows file sharing over complex, interconnected networks, including the public Internet. </p>\n<h2>Step-1: Cifs-utils Package installation</h2>\n<p>Insall Samba and CIFS utils.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo apt update\nsudo apt install smbclient cifs-utils</code></pre></div>\n<h2>Step-2: Check servers and mounts</h2>\n<p>For this article we will assume that server ip is <code class=\"language-text\">192.168.123.456</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">smbclient -L //192.168.123.456</code></pre></div>\n<p>This should list all the visible servers and shares.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ smbclient -L //192.168.123.456\nPassword for [WORKGROUP\\username]:\n\n\tSharename       Type      Comment\n\t---------       ----      -------\n\tdata            Disk      data and downloads\n\thome            Disk      Home directory of username\nSMB1 disabled -- no workgroup available</code></pre></div>\n<h2>Step-3: Creating Directory</h2>\n<p>We will now create directory for mounting the shared drive:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ sudo mkdir /media/share</code></pre></div>\n<p>Or if we want to mount for the current user only:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ sudo mkdir ~/share</code></pre></div>\n<h2>Step-4: Creating Credentials file</h2>\n<p>Instead of putting our username and password everywhere we will create a credentials file. In this example we will use <code class=\"language-text\">nano</code> editor but you can use any editor.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo nano /root/.servercred</code></pre></div>\n<p>Now we will enter username as password. You can also give domain like <code class=\"language-text\">WORKGROUP</code> but usually it's optional.</p>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre class=\"language-txt\"><code class=\"language-txt\">username=&lt;server-username&gt;\npassword=&lt;server-password&gt;\ndomain=value (optional)</code></pre></div>\n<p>Press <code class=\"language-text\">CTRL+S</code> to save the file and <code class=\"language-text\">CTRL+X</code> to exit from the nano editor.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo chmod 400 /root/.servercred</code></pre></div>\n<h2>Step-5: Mounting share</h2>\n<p>In this step we will assume that server ip is <code class=\"language-text\">192.168.123.456</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo mount -t cifs -o rw,vers=3.0,credentials=/root/.servercred //192.168.123.456/sharedDir /media/share</code></pre></div>\n<p>Above command gives only <code class=\"language-text\">root</code> to read and write. But if we want to give the write access to local user then we need to provide <code class=\"language-text\">uid</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo mount -t cifs -o rw,vers=3.0,credentials=/root/.servercred,uid=12345 //192.168.123.456/sharedDir /media/share</code></pre></div>\n<p>To unmount we can use:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo unmount -l /media/share</code></pre></div>\n<h2>Step-6: Auto Mounting</h2>\n<p>For this to automatically mount we need to update <code class=\"language-text\">fstab</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">sudo nano /etc/fstab</code></pre></div>\n<p>Append the config in the file, save and exit.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">//192.168.123.456/sharedDir /media/share cifs rw,vers=3.0,credentials=/root/.servercred</code></pre></div>"}},"pageContext":{"id":"5511505c-d8e1-58b0-9d2a-8abbaf64c030"}},"staticQueryHashes":["1271460761","2127526068","3159585216","805030655"]}