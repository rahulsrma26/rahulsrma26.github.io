<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-linux/systemd-scheduler/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.1">
<title data-rh="true">Using systemd as a scheduler | Rahul Sharma</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rahulsrma26.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://rahulsrma26.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://rahulsrma26.github.io/docs/linux/systemd-scheduler/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="XGiC2A6JxvD9Dpd1z7dzwB6lHkt2xzI3d_5Uutepg2Y"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using systemd as a scheduler | Rahul Sharma"><meta data-rh="true" name="description" content="Discover how to use systemd as a powerful and flexible scheduler for your Linux system. In this guide, we demonstrate setting up a weekly ZFS scrub on a personal PC using systemd timers. Learn why systemd timers are advantageous over traditional cron jobs, and explore other practical use cases for scheduling tasks such as backups, system updates, and maintenance scripts. Ensure your computer performs regular maintenance tasks even if it&#x27;s not always running with our step-by-step instructions."><meta data-rh="true" property="og:description" content="Discover how to use systemd as a powerful and flexible scheduler for your Linux system. In this guide, we demonstrate setting up a weekly ZFS scrub on a personal PC using systemd timers. Learn why systemd timers are advantageous over traditional cron jobs, and explore other practical use cases for scheduling tasks such as backups, system updates, and maintenance scripts. Ensure your computer performs regular maintenance tasks even if it&#x27;s not always running with our step-by-step instructions."><meta data-rh="true" name="keywords" content="systemd scheduler,systemd timers,ZFS scrub automation,Linux task scheduling,cron vs systemd,Weekly ZFS scrub setup,systemd timer tutorial,Automated maintenance tasks Linux,Linux backup scheduling,System updates with systemd,Personal PC task automation"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://rahulsrma26.github.io/docs/linux/systemd-scheduler/"><link data-rh="true" rel="alternate" href="https://rahulsrma26.github.io/docs/linux/systemd-scheduler/" hreflang="en"><link data-rh="true" rel="alternate" href="https://rahulsrma26.github.io/docs/linux/systemd-scheduler/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/articles/rss.xml" title="Rahul Sharma RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/articles/atom.xml" title="Rahul Sharma Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.42b8a076.css">
<script src="/assets/js/runtime~main.3b2f4c76.js" defer="defer"></script>
<script src="/assets/js/main.8b8e75de.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Rahul Sharma</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/articles">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a class="navbar__item navbar__link" href="/gallery">Gallery</a><a class="navbar__item navbar__link" href="/about">About</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Tutorials, Courses and Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/python-course/">Python 3 Course</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/linux/">Linux Misc</a><button aria-label="Collapse sidebar category &#x27;Linux Misc&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/ssh-jump/">Passwordless SSH and Jump servers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/smb-mount/">Mounting SMB share on Debian</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linux/zfs-mirror/">Creating mirrored zfs on Debian</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/linux/systemd-scheduler/">Using systemd as a scheduler</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/linux/"><span itemprop="name">Linux Misc</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using systemd as a scheduler</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using systemd as a scheduler</h1></header><p>Scheduling tasks on a personal computer is crucial for maintaining performance, performing regular maintenance tasks like backups or scrubs, and automating repetitive actions. While <code>cron</code> has been the traditional tool for task scheduling on Unix-like systems, <code>systemd</code> timers offer a more robust and flexible alternative, especially for systems that are not always running, like PCs. This blog post will explore how you can use <code>systemd</code> as a scheduler, including an example of setting up a weekly ZFS scrub using <code>systemd</code> timers.</p>
<p><strong>Some background:</strong></p>
<p>I have recently set up a ZFS pool (<a href="/docs/linux/zfs-mirror/">tutorial</a>) for write-intensive applications, such as creating and destroying Docker containers, web scraping, or generating gigabytes of random images for model training. I want to schedule a weekly scrub, but since it’s a PC, <code>cron</code> won’t work reliably due to the variable on/off times of the computer. This is where I started looking for alternatives.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-use-systemd-timers-over-cron">Why Use <code>systemd</code> Timers Over <code>cron</code>?<a href="#why-use-systemd-timers-over-cron" class="hash-link" aria-label="Direct link to why-use-systemd-timers-over-cron" title="Direct link to why-use-systemd-timers-over-cron">​</a></h2>
<p><code>systemd</code> timers provide several advantages over <code>cron</code>:</p>
<ul>
<li><strong>Persistent Timers</strong>: If a computer is off when the timer is supposed to run, <code>systemd</code> can ensure the task is executed as soon as possible once the system is back online.</li>
<li><strong>More Powerful Scheduling</strong>: <code>systemd</code> timers support a more powerful scheduling syntax, allowing for more complex scheduling scenarios.</li>
<li><strong>Unified Management</strong>: Since many modern Linux distributions use <code>systemd</code> for service management, using <code>systemd</code> timers allows you to manage all services and scheduled tasks uniformly.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-a-weekly-zfs-scrub-with-systemd-timer">Setting Up a Weekly ZFS Scrub with <code>systemd</code> Timer<a href="#setting-up-a-weekly-zfs-scrub-with-systemd-timer" class="hash-link" aria-label="Direct link to setting-up-a-weekly-zfs-scrub-with-systemd-timer" title="Direct link to setting-up-a-weekly-zfs-scrub-with-systemd-timer">​</a></h2>
<p>ZFS scrubbing is a maintenance task that scans the storage pool for data integrity and repairs any inconsistencies. It is essential to run scrubs regularly, especially on systems using SSDs or other storage mediums that benefit from regular checks. In this example, we&#x27;ll set up a weekly ZFS scrub using <code>systemd</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-creating-a-systemd-service-for-zfs-scrub">1. Creating a <code>systemd</code> Service for ZFS Scrub<a href="#1-creating-a-systemd-service-for-zfs-scrub" class="hash-link" aria-label="Direct link to 1-creating-a-systemd-service-for-zfs-scrub" title="Direct link to 1-creating-a-systemd-service-for-zfs-scrub">​</a></h3>
<p>First, we need to create a <code>systemd</code> service file that defines the ZFS scrub command. This service will be executed by our timer.</p>
<ol>
<li>
<p>Create a new service file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/systemd/system/zfs-scrub.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the following content to the file:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=ZFS scrub for all pools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=oneshot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/sbin/zpool scrub &lt;pool_name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Replace <code>&lt;pool_name&gt;</code> with the name of your ZFS pool (e.g., <code>mypool</code>). If you have multiple pools, add multiple <code>ExecStart</code> lines:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/sbin/zpool scrub pool1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/sbin/zpool scrub pool2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Save and exit the file.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-creating-a-systemd-timer-for-the-service">2. Creating a <code>systemd</code> Timer for the Service<a href="#2-creating-a-systemd-timer-for-the-service" class="hash-link" aria-label="Direct link to 2-creating-a-systemd-timer-for-the-service" title="Direct link to 2-creating-a-systemd-timer-for-the-service">​</a></h3>
<p>Next, we create a <code>systemd</code> timer that will trigger the service on a weekly schedule.</p>
<ol>
<li>
<p>Create a new timer file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo nano /etc/systemd/system/zfs-scrub.timer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Add the following content to the file:</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Weekly ZFS scrub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Timer]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OnCalendar=weekly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Persistent=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=timers.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong><code>OnCalendar=weekly</code></strong>: This schedules the timer to trigger once a week.</li>
<li><strong><code>Persistent=true</code></strong>: Ensures that the scrub runs as soon as possible if the PC was off during the scheduled time.</li>
</ul>
</li>
<li>
<p>Save and exit the file.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-enabling-and-starting-the-timer">3. Enabling and Starting the Timer<a href="#3-enabling-and-starting-the-timer" class="hash-link" aria-label="Direct link to 3. Enabling and Starting the Timer" title="Direct link to 3. Enabling and Starting the Timer">​</a></h3>
<ol>
<li>
<p>Reload <code>systemd</code> to recognize the new service and timer:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl daemon-reload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Enable the timer so that it starts on boot:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl enable zfs-scrub.timer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Start the timer immediately:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl start zfs-scrub.timer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-verifying-the-timer">4. Verifying the Timer<a href="#4-verifying-the-timer" class="hash-link" aria-label="Direct link to 4. Verifying the Timer" title="Direct link to 4. Verifying the Timer">​</a></h3>
<p>To verify that the timer is active and see when it will run next, use:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl list-timers --all | grep zfs-scrub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see output indicating when the next run is scheduled.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advantages-of-using-systemd-timers-for-personal-pcs">Advantages of Using <code>systemd</code> Timers for Personal PCs<a href="#advantages-of-using-systemd-timers-for-personal-pcs" class="hash-link" aria-label="Direct link to advantages-of-using-systemd-timers-for-personal-pcs" title="Direct link to advantages-of-using-systemd-timers-for-personal-pcs">​</a></h2>
<p>For personal computers that may not be running 24/7, <code>systemd</code> timers provide a reliable way to ensure maintenance tasks are executed regularly:</p>
<ul>
<li><strong>Handles Missed Runs</strong>: Unlike <code>cron</code>, <code>systemd</code> timers with the <code>Persistent=true</code> setting will catch up on missed runs the next time the computer is powered on.</li>
<li><strong>Easier Management</strong>: Using <code>systemctl</code> commands, you can start, stop, enable, disable, and inspect timers easily.</li>
<li><strong>Unified Configuration</strong>: With <code>systemd</code>, both services and scheduled tasks are managed in a consistent manner.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-use-cases-for-systemd-timers">Other Use Cases for <code>systemd</code> Timers<a href="#other-use-cases-for-systemd-timers" class="hash-link" aria-label="Direct link to other-use-cases-for-systemd-timers" title="Direct link to other-use-cases-for-systemd-timers">​</a></h2>
<p>In addition to ZFS scrubbing, you can use <code>systemd</code> timers to schedule various tasks:</p>
<ul>
<li><strong>Backups</strong>: Schedule regular backups with tools like <code>rsync</code>.</li>
<li><strong>System Updates</strong>: Run system updates automatically on a regular basis.</li>
<li><strong>Maintenance Scripts</strong>: Run custom maintenance scripts that clean up logs, rotate files, or perform other housekeeping tasks.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p><code>systemd</code> timers provide a powerful and flexible way to schedule tasks on your Linux system, especially for personal PCs that are not always on. By using <code>systemd</code> timers, you can ensure important maintenance tasks like ZFS scrubbing are performed regularly without worrying about whether the computer was on at the scheduled time. With its persistent and robust scheduling capabilities, <code>systemd</code> is an excellent choice for automating tasks and maintaining the health of your system.</p>
<p>By following the example provided, you can set up a weekly ZFS scrub to maintain your data integrity and keep your storage pool in top condition. This method can be extended to other maintenance tasks, making <code>systemd</code> a versatile scheduler for personal and professional use.</p>
<hr>
<p>First published on 2024-08-14</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/linux">linux</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/service">service</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/ai-assisted">ai-assisted</a></li></ul></div></div></footer><div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/linux/zfs-mirror/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Creating mirrored zfs on Debian</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-use-systemd-timers-over-cron" class="table-of-contents__link toc-highlight">Why Use <code>systemd</code> Timers Over <code>cron</code>?</a></li><li><a href="#setting-up-a-weekly-zfs-scrub-with-systemd-timer" class="table-of-contents__link toc-highlight">Setting Up a Weekly ZFS Scrub with <code>systemd</code> Timer</a><ul><li><a href="#1-creating-a-systemd-service-for-zfs-scrub" class="table-of-contents__link toc-highlight">1. Creating a <code>systemd</code> Service for ZFS Scrub</a></li><li><a href="#2-creating-a-systemd-timer-for-the-service" class="table-of-contents__link toc-highlight">2. Creating a <code>systemd</code> Timer for the Service</a></li><li><a href="#3-enabling-and-starting-the-timer" class="table-of-contents__link toc-highlight">3. Enabling and Starting the Timer</a></li><li><a href="#4-verifying-the-timer" class="table-of-contents__link toc-highlight">4. Verifying the Timer</a></li></ul></li><li><a href="#advantages-of-using-systemd-timers-for-personal-pcs" class="table-of-contents__link toc-highlight">Advantages of Using <code>systemd</code> Timers for Personal PCs</a></li><li><a href="#other-use-cases-for-systemd-timers" class="table-of-contents__link toc-highlight">Other Use Cases for <code>systemd</code> Timers</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><span class="footer__link-item">
              See a typo or want to contribute? submit a PR or issue on <a href="https://github.com/rahulsrma26/rahulsrma26.github.io/" target="_blank" rel="noreferrer noopener">the Github repo</a>!
              <br>
              This website is built with <a href="https://docusaurus.io/" target="_blank" rel="noreferrer noopener">Docusaurus</a>.
              <br>
              Last build on Tue, 03 Dec 2024 16:31:38 GMT.
            </span></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Rahul Sharma.</div></div></div></footer></div>
</body>
</html>